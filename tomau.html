<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√© T·∫≠p T√¥ M√†u - Tr√≤ Ch∆°i S√°ng T·∫°o</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f0f9ff;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            touch-action: manipulation;
        }
        .color-swatch {
            transition: transform 0.2s;
            cursor: pointer;
        }
        .color-swatch:hover {
            transform: scale(1.1);
        }
        .color-swatch.active {
            border: 4px solid #333;
            transform: scale(1.1);
        }
        .paint-area {
            cursor: pointer;
            transition: fill 0.3s ease;
            stroke: #333;
            stroke-width: 3;
            stroke-linejoin: round;
        }
        .paint-area:hover {
            opacity: 0.8;
        }
        .animal-option {
            cursor: pointer;
            transition: all 0.2s;
            border-width: 4px;
        }
        .animal-option:hover {
            transform: translateY(-5px);
            border-color: #93c5fd;
        }
        .animal-option.active {
            border-color: #ec4899;
            background-color: #fce7f3;
        }
        .animal-list::-webkit-scrollbar {
            height: 8px;
        }
        .animal-list::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
    </style>
</head>
<body class="flex flex-col items-center min-h-screen p-4">

    <!-- Header -->
    <header class="text-center mb-6">
        <h1 class="text-4xl font-bold text-pink-500 drop-shadow-md">üé® B√© T·∫≠p T√¥ M√†u üé®</h1>
        <p class="text-blue-600 font-medium">Ch·ªçn con v·∫≠t b√© y√™u th√≠ch v√† b·∫Øt ƒë·∫ßu t√¥ m√†u nh√©!</p>
    </header>

    <!-- Animal Selector -->
    <div class="animal-list flex gap-4 mb-6 overflow-x-auto pb-4 w-full max-w-4xl px-4">
        <div onclick="switchAnimal('fish')" id="opt-fish" class="animal-option active flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üêü</span>
            <span class="font-bold text-gray-700 text-sm">Con C√°</span>
        </div>
        <div onclick="switchAnimal('bear')" id="opt-bear" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üêª</span>
            <span class="font-bold text-gray-700 text-sm">Con G·∫•u</span>
        </div>
        <div onclick="switchAnimal('butterfly')" id="opt-butterfly" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">ü¶ã</span>
            <span class="font-bold text-gray-700 text-sm">Con B∆∞·ªõm</span>
        </div>
        <div onclick="switchAnimal('turtle')" id="opt-turtle" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üê¢</span>
            <span class="font-bold text-gray-700 text-sm">Con R√πa</span>
        </div>
        <div onclick="switchAnimal('bird')" id="opt-bird" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üê¶</span>
            <span class="font-bold text-gray-700 text-sm">Con Chim</span>
        </div>
        <div onclick="switchAnimal('crab')" id="opt-crab" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">ü¶Ä</span>
            <span class="font-bold text-gray-700 text-sm">Con Cua</span>
        </div>
        <div onclick="switchAnimal('elephant')" id="opt-elephant" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üêò</span>
            <span class="font-bold text-gray-700 text-sm">Con Voi</span>
        </div>
        <div onclick="switchAnimal('rabbit')" id="opt-rabbit" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üê∞</span>
            <span class="font-bold text-gray-700 text-sm">Con Th·ªè</span>
        </div>
        <div onclick="switchAnimal('caterpillar')" id="opt-caterpillar" class="animal-option flex flex-col items-center p-3 rounded-2xl bg-white min-w-[100px] shadow-sm">
            <span class="text-3xl">üêõ</span>
            <span class="font-bold text-gray-700 text-sm">Con S√¢u</span>
        </div>
    </div>

    <!-- Main Game Area -->
    <div class="w-full max-w-5xl bg-white rounded-3xl shadow-2xl p-6 flex flex-col md:flex-row gap-8 items-center border-8 border-yellow-300">
        
        <!-- Palette -->
        <div class="flex md:flex-col flex-wrap justify-center gap-3 w-full md:w-32">
            <div id="palette" class="grid grid-cols-4 md:grid-cols-2 gap-2"></div>
            <button id="clearBtn" class="mt-4 bg-red-400 hover:bg-red-500 text-white font-bold py-2 px-4 rounded-full shadow-lg transition text-xs uppercase tracking-wider">
                X√≥a H·∫øt üóëÔ∏è
            </button>
            <button id="downloadBtn" class="mt-2 bg-green-400 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-full shadow-lg transition text-xs uppercase tracking-wider">
                L∆∞u ·∫¢nh üì∏
            </button>
        </div>

        <!-- Canvas -->
        <div id="canvas-container" class="relative flex-1 flex justify-center items-center bg-gray-50 rounded-xl border-4 border-dashed border-blue-200 p-4 w-full h-[450px]">
            <svg id="coloring-svg" viewBox="0 0 500 400" class="w-full h-full drop-shadow-lg">
                <g id="animal-group"></g>
            </svg>
        </div>
    </div>

    <div id="message" class="mt-6 text-xl font-bold text-purple-600 opacity-0 transition-opacity duration-500">
        Tuy·ªát v·ªùi! B√© t√¥ m√†u ƒë·∫πp qu√°! üåü
    </div>

    <script>
        const colors = [
            '#FF0000', '#FF7F00', '#FFFF00', '#00FF00', 
            '#0000FF', '#4B0082', '#9400D3', '#FF69B4',
            '#FFC0CB', '#00CED1', '#8B4513', '#7CFC00',
            '#808080', '#000000', '#FFFFFF', '#FFA500',
            '#FFE4B5', '#AFEEEE', '#D8BFD8', '#F0E68C'
        ];

        let selectedColor = colors[0];
        const animalGroup = document.getElementById('animal-group');
        const messageEl = document.getElementById('message');

        const animals = {
            fish: `
                <path class="paint-area" fill="#ffffff" d="M100,200 C100,100 350,100 400,200 C350,300 100,300 100,200 Z" />
                <path class="paint-area" fill="#ffffff" d="M100,200 L30,150 L30,250 Z" />
                <path class="paint-area" fill="#ffffff" d="M200,135 C230,80 300,80 330,135 Z" />
                <path class="paint-area" fill="#ffffff" d="M220,265 C250,320 300,320 320,265 Z" />
                <path class="paint-area" fill="#ffffff" d="M330,135 C380,150 400,200 330,265 C310,230 310,170 330,135 Z" />
                <circle cx="365" cy="185" r="8" fill="#333" />
            `,
            bear: `
                <circle class="paint-area" fill="#ffffff" cx="180" cy="130" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="320" cy="130" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="250" cy="220" r="100" />
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="260" rx="45" ry="35" />
                <circle cx="215" cy="190" r="10" fill="#333" />
                <circle cx="285" cy="190" r="10" fill="#333" />
                <ellipse cx="250" cy="245" rx="12" ry="8" fill="#333" />
            `,
            butterfly: `
                <path class="paint-area" fill="#ffffff" d="M250,200 Q100,50 50,200 Q100,350 250,200" />
                <path class="paint-area" fill="#ffffff" d="M250,230 Q120,380 80,280 Q150,230 250,230" />
                <path class="paint-area" fill="#ffffff" d="M250,200 Q400,50 450,200 Q400,350 250,200" />
                <path class="paint-area" fill="#ffffff" d="M250,230 Q380,380 420,280 Q350,230 250,230" />
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="200" rx="15" ry="100" />
            `,
            turtle: `
                <path class="paint-area" fill="#ffffff" d="M400,200 C450,200 480,240 400,260 C400,260 380,200 400,200" />
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="220" rx="140" ry="100" />
                <path class="paint-area" fill="#ffffff" d="M250,140 L200,180 L200,240 L250,280 L300,240 L300,180 Z" />
                <path class="paint-area" fill="#ffffff" d="M200,180 L140,160 L120,220 L200,240 Z" />
                <path class="paint-area" fill="#ffffff" d="M300,180 L360,160 L380,220 L300,240 Z" />
                <circle cx="440" cy="220" r="5" fill="#333" />
            `,
            bird: `
                <circle class="paint-area" fill="#ffffff" cx="350" cy="150" r="60" />
                <path class="paint-area" fill="#ffffff" d="M350,210 C350,320 150,320 150,210 C150,150 250,150 350,210" />
                <path class="paint-area" fill="#ffffff" d="M150,210 L50,180 L80,250 Z" />
                <path class="paint-area" fill="#ffffff" d="M220,210 Q250,100 320,210" />
                <path class="paint-area" fill="#ffffff" d="M410,140 L450,155 L410,170 Z" />
                <circle cx="370" cy="130" r="7" fill="#333" />
            `,
            crab: `
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="250" rx="120" ry="80" />
                <path class="paint-area" fill="#ffffff" d="M150,180 Q100,100 50,150 Q100,200 150,180" />
                <path class="paint-area" fill="#ffffff" d="M150,180 Q100,150 70,220 Q120,230 150,180" />
                <path class="paint-area" fill="#ffffff" d="M350,180 Q400,100 450,150 Q400,200 350,180" />
                <path class="paint-area" fill="#ffffff" d="M350,180 Q400,150 430,220 Q380,230 350,180" />
                <circle class="paint-area" fill="#ffffff" cx="200" cy="130" r="20" />
                <circle class="paint-area" fill="#ffffff" cx="300" cy="130" r="20" />
                <circle cx="205" cy="125" r="5" fill="#333" />
            `,
            elephant: `
                <circle class="paint-area" fill="#ffffff" cx="320" cy="180" r="80" /> <!-- ƒê·∫ßu -->
                <path class="paint-area" fill="#ffffff" d="M320,230 Q320,350 240,350 Q200,350 240,300" /> <!-- V√≤i -->
                <ellipse class="paint-area" fill="#ffffff" cx="240" cy="180" rx="60" ry="90" /> <!-- Tai -->
                <ellipse class="paint-area" fill="#ffffff" cx="380" cy="250" rx="100" ry="80" /> <!-- Th√¢n -->
                <rect class="paint-area" fill="#ffffff" x="320" y="320" width="40" height="60" /> <!-- Ch√¢n -->
                <rect class="paint-area" fill="#ffffff" x="420" y="320" width="40" height="60" /> <!-- Ch√¢n -->
                <circle cx="350" cy="160" r="8" fill="#333" />
            `,
            rabbit: `
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="200" rx="70" ry="60" /> <!-- ƒê·∫ßu -->
                <ellipse class="paint-area" fill="#ffffff" cx="220" cy="90" rx="20" ry="70" /> <!-- Tai tr√°i -->
                <ellipse class="paint-area" fill="#ffffff" cx="280" cy="90" rx="20" ry="70" /> <!-- Tai ph·∫£i -->
                <ellipse class="paint-area" fill="#ffffff" cx="250" cy="300" rx="90" ry="70" /> <!-- Th√¢n -->
                <circle class="paint-area" fill="#ffffff" cx="170" cy="330" r="25" /> <!-- Ch√¢n -->
                <circle class="paint-area" fill="#ffffff" cx="330" cy="330" r="25" /> <!-- Ch√¢n -->
                <circle cx="225" cy="185" r="6" fill="#333" />
                <circle cx="275" cy="185" r="6" fill="#333" />
                <path d="M240,210 Q250,225 260,210" fill="none" stroke="#333" stroke-width="2" />
            `,
            caterpillar: `
                <circle class="paint-area" fill="#ffffff" cx="100" cy="250" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="170" cy="230" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="240" cy="250" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="310" cy="230" r="40" />
                <circle class="paint-area" fill="#ffffff" cx="385" cy="200" r="50" /> <!-- ƒê·∫ßu -->
                <line x1="370" y1="155" x2="350" y2="120" stroke="#333" stroke-width="3" />
                <line x1="400" y1="155" x2="420" y2="120" stroke="#333" stroke-width="3" />
                <circle cx="370" cy="190" r="6" fill="#333" />
                <circle cx="410" cy="190" r="6" fill="#333" />
            `
        };

        function initPalette() {
            const paletteEl = document.getElementById('palette');
            paletteEl.innerHTML = ''; 
            colors.forEach((color, index) => {
                const swatch = document.createElement('div');
                swatch.className = `color-swatch w-10 h-10 rounded-full border-2 border-white shadow-md ${color === selectedColor ? 'active' : ''}`;
                swatch.style.backgroundColor = color;
                swatch.onclick = () => {
                    document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
                    swatch.classList.add('active');
                    selectedColor = color;
                };
                paletteEl.appendChild(swatch);
            });
        }

        window.switchAnimal = function(animalKey) {
            document.querySelectorAll('.animal-option').forEach(opt => opt.classList.remove('active'));
            const activeOpt = document.getElementById(`opt-${animalKey}`);
            if (activeOpt) activeOpt.classList.add('active');
            
            animalGroup.innerHTML = animals[animalKey];
            
            const areas = document.querySelectorAll('.paint-area');
            areas.forEach(area => {
                area.addEventListener('click', function() {
                    this.setAttribute('fill', selectedColor);
                    showFeedback();
                });
            });
            messageEl.style.opacity = '0';
        };

        function showFeedback() {
            messageEl.style.opacity = '1';
            setTimeout(() => { messageEl.style.opacity = '0'; }, 3000);
        }

        document.getElementById('clearBtn').onclick = () => {
            document.querySelectorAll('.paint-area').forEach(area => area.setAttribute('fill', '#ffffff'));
        };

        document.getElementById('downloadBtn').onclick = () => {
            const svg = document.getElementById('coloring-svg');
            const svgData = new XMLSerializer().serializeToString(svg);
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");
            const img = new Image();
            canvas.width = 1000; canvas.height = 800;
            const svgBlob = new Blob([svgData], {type: "image/svg+xml;charset=utf-8"});
            const url = URL.createObjectURL(svgBlob);
            img.onload = function() {
                ctx.fillStyle = "#f0f9ff"; ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.drawImage(img, 0, 0, 1000, 800);
                const downloadLink = document.createElement("a");
                downloadLink.href = canvas.toDataURL("image/png");
                downloadLink.download = "tac-pham-cua-be.png";
                downloadLink.click();
                URL.revokeObjectURL(url);
            };
            img.src = url;
        };

        initPalette();
        switchAnimal('fish');
    </script>
</body>
</html>